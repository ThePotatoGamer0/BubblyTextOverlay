<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customizable OBS Overlay</title>
    
    <!-- Adding Google Fonts so we can change them via URL -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Montserrat:wght@400;700;900&family=Roboto:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: rgba(0, 0, 0, 0);
            margin: 0;
            padding: 40px;
            overflow: hidden;
            /* Default styles that can be overridden by JS */
            font-family: 'Inter', sans-serif;
            color: white;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
        }

        #animated-text {
            /* Default font size, can be overridden */
            font-size: 80px; 
            display: flex;
            flex-wrap: wrap;
        }

        #animated-text span {
            display: inline-block;
            min-width: 0.3em;
        }
    </style>
</head>
<body>

    <div id="animated-text"></div>

    <script type="module">
        import { animate, stagger } from "https://cdn.jsdelivr.net/npm/motion@latest/+esm";

        // --- Step 1: Get all parameters from the URL with sensible defaults ---
        const urlParams = new URLSearchParams(window.location.search);

        // Text & Style Parameters
        const text = urlParams.get('text') || "Hello World";
        const fontFamily = urlParams.get('fontFamily') || "'Inter', sans-serif";
        const fontSize = urlParams.get('fontSize') || '80'; // in pixels
        const fontWeight = urlParams.get('fontWeight') || 'bold';
        const color = urlParams.get('color') || 'white';
        
        // Animation Parameters
        const duration = parseFloat(urlParams.get('duration') || '1.5'); // in seconds
        const staggerDelay = parseFloat(urlParams.get('stagger') || '0.05'); // in seconds
        const bounceHeight = urlParams.get('bounce') || '-40'; // percentage

        
        // --- Step 2: Apply the dynamic styles to the text container ---
        const textContainer = document.querySelector('#animated-text');
        textContainer.style.fontFamily = fontFamily;
        textContainer.style.fontSize = `${fontSize}px`;
        textContainer.style.fontWeight = fontWeight;
        textContainer.style.color = color;


        // --- Step 3: Split the text into individual letter spans ---
        textContainer.textContent = text; 
        const originalText = textContainer.textContent;
        textContainer.textContent = ''; 

        originalText.split('').forEach(char => {
            const span = document.createElement('span');
            span.innerHTML = char === ' ' ? '&nbsp;' : char;
            textContainer.appendChild(span);
        });


        // --- Step 4: Animate using the dynamic parameters ---
        const spans = document.querySelectorAll('#animated-text span');

        animate(
            spans,
            {
                // Keyframes are now built from a URL parameter
                y: ["0%", `${bounceHeight}%`, "0%"]
            },
            {
                // Animation properties are now from URL parameters
                duration: duration,
                delay: stagger(staggerDelay),
                repeat: Infinity,
                easing: "ease-in-out"
            }
        );
    </script>
</body>
</html>
